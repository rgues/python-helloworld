{"version":3,"sources":["./src/app/dashboard/my-tontines/tontine-detail/stat-pools/stat-pools.module.ts","./src/app/dashboard/my-tontines/tontine-detail/stat-pools/stat-pools.page.scss","./src/app/dashboard/my-tontines/tontine-detail/stat-pools/stat-pools.page.html","./src/app/dashboard/my-tontines/tontine-detail/stat-pools/stat-pools.page.ts"],"names":[],"mappings":"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","file":"stat-pools-stat-pools-module.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { StatPoolsPage } from './stat-pools.page';\nimport { SharedModule } from 'src/app/shared/shared.module';\nimport { CommonModule } from '@angular/common';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: StatPoolsPage\n  }\n];\n\n@NgModule({\n  imports: [\n    CommonModule,\n    SharedModule,\n    IonicModule,\n    RouterModule.forChild(routes)\n  ],\n  declarations: [StatPoolsPage]\n})\nexport class StatPoolsPageModule {}\n","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzdGF0LXBvb2xzLnBhZ2Uuc2NzcyJ9 */\";","export default \"<ion-header>\\r\\n  <ion-toolbar>\\r\\n    <ion-buttons slot=\\\"start\\\">\\r\\n      <ion-back-button color=\\\"primary\\\" [defaultHref]=\\\"['/','dashboard','my-tontines',tontineId,'stat']\\\" slot=\\\"text-only\\\"></ion-back-button>\\r\\n    </ion-buttons>\\r\\n    <ion-avatar slot=\\\"start\\\">\\r\\n        <ion-img [src]=\\\"'assets/join-icon.svg'\\\" class=\\\"thumb-img\\\"></ion-img>\\r\\n    </ion-avatar>\\r\\n    <ion-title class=\\\"ion-padding\\\">\\r\\n      {{ 'FINANCIAL_STATISQUE' | translate }}\\r\\n    </ion-title>\\r\\n  </ion-toolbar>\\r\\n  <ion-toolbar class=\\\"ion-text-center subtitle\\\">\\r\\n    <ion-title>{{ 'CYCLE_TEXT' | translate }} #{{currentCycle && currentCycle.numerocycle ? currentCycle.numerocycle : 0}}</ion-title>\\r\\n  </ion-toolbar>\\r\\n</ion-header>\\r\\n\\r\\n<ion-content>\\r\\n\\r\\n  <ion-refresher slot=\\\"fixed\\\" (ionRefresh)=\\\"refreSher($event)\\\">\\r\\n    <ion-refresher-content\\r\\n      pullingIcon=\\\"reload-outline\\\"\\r\\n      refreshingSpinner=\\\"circles\\\"\\r\\n      refreshingText=\\\"{{ 'M_REFRESHING_TEXT' | translate }}\\\">\\r\\n    </ion-refresher-content>\\r\\n  </ion-refresher>\\r\\n  <p class=\\\"ion-text-center\\\"  *ngIf=\\\"loading\\\">\\r\\n    <ion-spinner  name=\\\"circles\\\"></ion-spinner>\\r\\n  </p>\\r\\n  <ion-grid *ngIf=\\\"!loading\\\">\\r\\n    <ion-row>\\r\\n      <ion-col>\\r\\n        {{ 'TOTAL_NUMBER_POOLS' | translate }}: {{defaultList.length}}\\r\\n      </ion-col>\\r\\n    </ion-row>\\r\\n    <ion-row>\\r\\n      <ion-col>\\r\\n        <ion-list>\\r\\n          <ion-item  *ngFor=\\\"let pool of seances\\\" [routerLink]=\\\"['/', 'dashboard', 'my-tontines', tontineId, 'stat', 'pools',  pool.seance.id]\\\" detail>\\r\\n            <ion-label>\\r\\n              <ion-text color=\\\"primary\\\"><h2>{{pool.seance.date_debut.split(' ')[0]}}</h2></ion-text>             \\r\\n            </ion-label>\\r\\n          </ion-item>\\r\\n        </ion-list>\\r\\n      </ion-col>\\r\\n    </ion-row>\\r\\n  </ion-grid>\\r\\n\\r\\n  <ion-infinite-scroll threshold=\\\"100px\\\" (ionInfinite)=\\\"infinteScrollData($event)\\\">\\r\\n    <ion-infinite-scroll-content\\r\\n      loadingSpinner=\\\"bubbles\\\"\\r\\n      loadingText=\\\"{{ 'M_LOADING_MORE_DATA' | translate }}\\\">\\r\\n    </ion-infinite-scroll-content>\\r\\n  </ion-infinite-scroll>\\r\\n</ion-content>\\r\\n\";","import { Component, OnInit, ViewChild } from '@angular/core';\r\nimport { TontineService } from '../../services/tontine.service';\r\nimport { ErrorService } from 'src/app/shared/service/error.service';\r\nimport { IonInfiniteScroll } from '@ionic/angular';\r\nimport { UtilService } from 'src/app/shared/service/util.service';\r\n\r\n@Component({\r\n  selector: 'app-stat-pools',\r\n  templateUrl: './stat-pools.page.html',\r\n  styleUrls: ['./stat-pools.page.scss'],\r\n})\r\nexport class StatPoolsPage implements OnInit {\r\n\r\n  seances: any;\r\n  defaultList: any;\r\n  tontineData: any;\r\n  nbreCycle: number;\r\n  currentCycle: any;\r\n  tontineId: number;\r\n  loading: boolean;\r\n  allData: any;\r\n  nbItems: number;\r\n  @ViewChild(IonInfiniteScroll, { static: false }) infiniteScroll: IonInfiniteScroll;\r\n\r\n  constructor(\r\n    private tontine: TontineService,\r\n    private error: ErrorService,\r\n    private util: UtilService,\r\n  ) {\r\n    this.seances = [];\r\n    this.defaultList = [];\r\n    this.tontineData = this.tontine.getCurrentTontineData();\r\n    this.tontineId = this.tontineData.tontine.tontine_id;\r\n    this.nbreCycle = 0;\r\n    this.loading = true;\r\n    this.allData = [];\r\n    this.nbItems = 15;\r\n  }\r\n\r\n  ngOnInit() {\r\n    this.getCycleSeances(null);\r\n  }\r\n\r\n  // Get the tontine's seances of cycles\r\n  getCycleSeances(event: any) {\r\n    this.tontine.getCurrentSeanceData().then((cycle: any) => {\r\n      this.currentCycle = cycle.data.cycle;\r\n      this.nbreCycle = cycle.nbCycles;\r\n      this.getTontinesSeanceData(this.currentCycle, event);\r\n    });\r\n  }\r\n\r\n  // Get the tontine's cycles\r\n  getTontinesSeanceData(cycleData: any, event) {\r\n    this.tontine.getTontinesCyclesSeances(cycleData.id).subscribe((reponse: any) => {\r\n      console.log(reponse);\r\n      if (reponse && reponse.message === 'success') {\r\n        if (reponse.seances && reponse.seances.length > 0) {\r\n          this.defaultList = reponse.seances;\r\n          this.defaultList = this.util.oderBySeanceDate(this.defaultList);\r\n\r\n          this.tontine.setCurrentSeanceData({ nbCycles: this.nbreCycle, data: { cycle: this.currentCycle, seances: this.defaultList } });\r\n\r\n          this.allData = this.defaultList;\r\n          if (this.allData.length > this.nbItems) {\r\n            this.seances = [];\r\n            for (let i = 0; i < this.nbItems; i++) {\r\n              this.seances.push(this.allData[this.seances.length]);\r\n            }\r\n          } else {\r\n            this.seances = this.allData;\r\n          }\r\n        }\r\n      }\r\n      this.loading = false;\r\n      if (event) {\r\n        setTimeout(() => {\r\n          event.target.complete();\r\n        }, 2000);\r\n      }\r\n    }, error => {\r\n      if (event) {\r\n        event.target.complete();\r\n      }\r\n      this.loading = false;\r\n      if (error && error.error && error.error.user_not_found) {\r\n        this.loading = true;\r\n        this.error.renewSession().then((data: any) => {\r\n          if (data && data.result === 'OK') {\r\n            this.getTontinesSeanceData(cycleData, event);\r\n          } else {\r\n            this.loading = false;\r\n          }\r\n        });\r\n      } else {\r\n        this.error.manageError(error);\r\n      }\r\n    });\r\n  }\r\n\r\n  // Refresh the list\r\n  refreSher(event) {\r\n    this.infiniteScroll.disabled = false;\r\n    this.getCycleSeances(event);\r\n  }\r\n\r\n  // Infinite scroll data\r\n  infinteScrollData(event) {\r\n    setTimeout(() => {\r\n      for (let i = 0; i < this.nbItems; i++) {\r\n        if (this.seances.length < this.allData.length) {\r\n          this.seances.push(this.allData[this.seances.length]);\r\n\r\n        } else if (this.seances.length === this.allData.length) {\r\n          event.target.disabled = true;\r\n        }\r\n      }\r\n      event.target.complete();\r\n    }, 500);\r\n  }\r\n\r\n}\r\n"],"sourceRoot":"webpack:///"}